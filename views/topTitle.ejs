<div class="main">
  <header class="header">
    <div class="header-left">
      <span id="menuToggle" class="menu-toggle" onClick="return allMenuOpen()">â˜°</span>
      <h1 id="topTitleData"></h1>
    </div>

    <div class="header-reserve-tabs fixed-tabs">

      <!-- ì¦ê²¨ì°¾ê¸° -->
      <span class="icon-btn favorite" title="ì¦ê²¨ì°¾ê¸°">â˜…</span>
      <div id="tabMenu">
        <!--
        <span href="#" class="reserve-tab active">Main</span>
        <span href="#" class="reserve-tab">êµ­ì œì„ ì˜ˆì•½</span>
        <span href="#" class="reserve-tab">êµ­ë‚´ì„ ì˜ˆì•½</span>
        <span href="#" class="reserve-tab">ì…ì¶œê¸ˆëŒ€ì¥</span>
        <span href="#" class="reserve-tab">ì˜¨ë¼ì¸í†µì¥</span>
        <span href="#" class="reserve-tab">í˜„ê¸ˆì˜ìˆ˜ì¦</span>
        -->
      </div>
      <!-- í”ŒëŸ¬ìŠ¤ 
      <span class="icon-btn add" title="ì¶”ê°€">ï¼‹</span>
      -->

    </div>
  
    <div class="header-right">
      ğŸ””
      <span><%= typeof userName !== 'undefined' ? userName : 'Guest' %></span>
      <span id="countdown" style="color: #bbb; display: none; padding-left: 10px; width: 80px; " >3:00:00</span>
      <span id="logoutBtn" class="btn-logout" onClick="location.href='/logout'">
        <%= (typeof userName !== 'undefined' ? "ë¡œê·¸ì•„ì›ƒ" : "ë¡œê·¸ì¸") %>
      </span>
    </div>
  </header>



<script>
  if ("<%= typeof userName !== 'undefined' ? userName : 'Guest' %>" !== "Guest") {
    $("#countdown").show();
    const loginTime = new Date(); // ë˜ëŠ” ì„œë²„ì—ì„œ ì „ë‹¬ëœ ë¡œê·¸ì¸ ì‹œê°
    window.expireTime = loginTime.getTime() + 3 * 60 * 60 * 1000; // 3ì‹œê°„ í›„
    const countdownEl = document.getElementById('countdown');

    function updateCountdown() {
        const now = new Date();
        let remaining = Math.max(0, window.expireTime - now); // ë‚¨ì€ ms

        if (remaining  > 0) {
            requestAnimationFrame(updateCountdown);
        } else {
            countdownEl.textContent = "00:00:00";
            top.newAlert('â° ë¡œê·¸ì¸ ì‹œê°„ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤.','reload');
            return;
        }

        const hours = String(Math.floor(remaining / 3600000)).padStart(2, '0');
        const minutes = String(Math.floor((remaining % 3600000) / 60000)).padStart(2, '0');
        const seconds = String(Math.floor((remaining % 60000) / 1000)).padStart(2, '0');


        countdownEl.textContent = `${hours}:${minutes}:${seconds}`;
    }
    requestAnimationFrame(updateCountdown);
}

</script>



<div class="allmenu-overlay" id="allMenu" style="display: block;">
  <div class="allmenu-panel">

    <div class="allmenu-header">
      <strong>ì „ì²´ë©”ë‰´</strong>
      <button class="allmenu-close" id="menuClose" onClick="return allMenuClose()">âœ•</button>
    </div>

    <div class="allmenu-grid" id="allMenuData">

      <div class="menu-group">
        <h4>ì˜ˆì•½ê´€ë¦¬</h4>
        <a href="#">â˜… êµ­ì œì„  ì˜ˆì•½</a>
        <a href="#">â˜† êµ­ë‚´ì„  ì˜ˆì•½</a>
        <a href="#">â˜† ë¼ì¸ê²°ì œ</a>
      </div>

      <div class="menu-group">
        <h4>ìƒí’ˆê´€ë¦¬</h4>
        <a href="#">â˜† ìƒí’ˆ ë¦¬ìŠ¤íŠ¸</a>
        <a href="#">â˜† ì¬ê³  ê´€ë¦¬</a>
        <a href="#">â˜† ìš´ì„ ê´€ë¦¬</a>
      </div>

      <div class="menu-group">
        <h4>ì •ì‚°/íšŒê³„</h4>
        <a href="#">â˜† í˜„ê¸ˆì˜ìˆ˜ì¦</a>
        <a href="#">â˜† ì„¸ê¸ˆê³„ì‚°ì„œ</a>
        <a href="#">â˜† ë§¤ì¶œê´€ë¦¬</a>
      </div>

      <div class="menu-group">
        <h4>ì‹œìŠ¤í…œ</h4>
        <a href="#">â˜† ê³µì§€ì‚¬í•­</a>
        <a href="#">â˜† ê¶Œí•œê´€ë¦¬</a>
        <a href="#">â˜† ê´€ë¦¬ì ì„¤ì •</a>
      </div>


    </div>
  </div>
</div>

<!-- ì „ì²´ë©”ë‰´ ì—´ê¸°ë‹«ê¸° -->
<script>
  /*
  document.addEventListener('DOMContentLoaded', () => {
  
    const menuToggle = document.getElementById('menuToggle');
    const allMenu = document.getElementById('allMenu');
    const menuClose = document.getElementById('menuClose');
  
    if (!menuToggle || !allMenu || !menuClose) {
      console.error('ì „ì²´ë©”ë‰´ ê´€ë ¨ ìš”ì†Œê°€ ì—†ìŠµë‹ˆë‹¤');
      return;
    }
  
    function openMenu() {
      allMenu.classList.add('active');
      document.body.classList.add('menu-open');
      menuToggle.classList.add('active');
    }
  
    function closeMenu() {
      allMenu.classList.remove('active');
      document.body.classList.remove('menu-open');
      menuToggle.classList.remove('active');
    }
  
    menuToggle.addEventListener('click', openMenu);
    menuClose.addEventListener('click', closeMenu);
  
    allMenu.addEventListener('click', (e) => {
      if (e.target === allMenu) closeMenu();
    });
  
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeMenu();
    });
  
    document.querySelectorAll('.menu-group a').forEach(link => {
      link.addEventListener('click', closeMenu);
    });
  
  });
  */
 function allMenuOpen() {
    $("#allMenu").addClass('active');
    menuOpenActive ();
 }
 function allMenuClose() {
    $("#allMenu").removeClass('active');
 }
 async function menuSignal(code, label) {
    if ($("#menu_" + code + "_signal").text() == 'â˜…') $("#menu_" + code + "_signal").text('â˜†');
    else $("#menu_" + code + "_signal").text('â˜…');  
    const data = "mode=menuChange&data="+code+"&label="+label;
    const res  = await fetch('/menuGet', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: data
    });
    const json        = await res.json();
    const success     = json.success;
    if (success == 'ok') {
        const data = "mode=menu";
        const res1  = await fetch('/menuGet', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: data
        });
        const json1 = await res1.json();
        const tabMenuData = json1.tabMenu;
        const frameData   = json1.frameMenu;
        $("#tabMenu").html(tabMenuData);
        $("#mainContent").html(frameData);
    }
 }
  </script>