<%- include('../header') %>

<link rel="stylesheet" href="/css/international.css">
<!--page_item--->
<main class="international">
    <!--page_item_top-->
    <form name="frmForm" method="post" id="frmForm" onsubmit="return false">
    <input type="hidden" name = "tmpData" value ="" id = "tmpData"> 
    <input type="hidden" name = "tmpData2" value ="" id = "tmpData2"> 
    <input type="hidden" name="titleData" value="">
    <div id="searchFrame">
        <div class="search_action_bar">
            <div class="search_action_left">
                <div class="search-options">
                    <div class="trip-type">
                        <button class="trip active"  ID="ticketType2" onClick="return typeChange('2')">ÏôïÎ≥µ</button>
                        <button class="trip"  ID="ticketType1" onClick="return typeChange('1')">Ìé∏ÎèÑ</button>
                        <button class="trip"  ID="ticketType3" onClick="return typeChange('3')">Îã§Íµ¨Í∞Ñ</button>
                        <label class="direct">
                            <input type="checkbox" name="stopover" value="Y" id="stopover" class="trip" ID="ticketDirect" > ÏßÅÌï≠ÎßåÏ°∞Ìöå
                        </label>
                    </div>
                </div>
            </div>
            <div class="search_action_right">
                <div class="search-actions tool-buttons">
                    <button class="btn teal" onClick="beforeSearchShow()">ÏµúÏ†ÅÌôî Í≤ÄÏÉâ ÏÑ§Ï†ï ‚ñæ</button>
                    <button class="btn navy secondary" onClick="ageCheckShow()">ÎÇòÏù¥Í≥ÑÏÇ∞</button>
                    <button class="btn orange secondary" onClick="monthSearch()">ÏõîÎ≥ÑÌé∏ÎèÑÍ≤ÄÏÉâ</button>
                    <button class="btn dark secondary" onClick="recentSearch()">ÏµúÍ∑ºÍ≤ÄÏÉâ</button>
                </div>
                <div style="position: relative;">
                    <%- include("bSearch.inc") %>
                    <%- include("age.inc") %>
                    <div id='SearchHistory' class="SearchHistory-layer detail-option" style="display: none;z-index:999; position: absolute; right: 80px; top:20px; width:900px ; max-height: 620px;">
                        <div class="close" onclick="$('#SearchHistory').hide(); document.body.style.overflow = ''; document.documentElement.style.overflow = '';"></div>
                        <div class="scroll_tabl" id="SearchHistoryArea"></div>
                    </div>
                    
                    <div id="revPopup" style="display:none; position: absolute; left: -638px; top: 0px; z-index: 9999;"></div>
                    
                </div>
            </div>
        </div>
    </div>

      <!-- Í≤ÄÏÉâÎ∞î -->
    <div class="search-bar">
       <!-- <div class="" id="singleArea"> -->
            <div class="search-item city-select" data-type="from">
                <span class="label">Ï∂úÎ∞úÎèÑÏãú</span>
                <!-- <strong id="fromText">Ïù∏Ï≤ú</strong> -->
                <strong id="departure_name_text">
                <input type="text" class="city-input" name="departure_name" id="departure_name" onClick="cityView('1','0')" onkeyup="autoComplete(this,'1','0')" autocomplete="off" value="Ïù∏Ï≤ú" placeholder="Ï∂úÎ∞úÎèÑÏãú">
                </strong>

            </div>

            <div class="swap">‚áÑ</div>

            <div class="search-item city-select" data-type="to">
                <span class="label">ÎèÑÏ∞©ÎèÑÏãú</span>
                <!-- <strong id="toText" class="is-placeholder">ÎèÑÏ∞©ÎèÑÏãú</strong> -->
                <strong id="arrive_name_text">
                <input type="text" class="city-input" name="arrive_name" id="arrive_name" onClick="cityView('2','0')" onkeyup="autoComplete(this,'2','0')" autocomplete="off" value="" placeholder="ÎèÑÏ∞©ÎèÑÏãú">
                </strong>
            </div>

            <div class="search-item date-select" id="openCalendar">
                <span class="label">Ï∂úÎ∞úÏùº</span>
                <!-- <strong id="departText">2025-12-25 (Î™©)</strong> -->
                <strong class="date-span" id="departure_date_name"  onClick="return generateCalendars('departure_date','CalendarLayer')"></strong>
            </div>

            <div class="search-item date-select" >
                <div id="openCalendarReturn">
                    <span class="label">Í∑ÄÍµ≠Ïùº</span>
                    <!-- <strong id="returnText">2025-12-27 (ÌÜ†)</strong> -->
                    <strong class="date-span" id="arrive_date_name"  onClick="return generateCalendars('arrive_date','CalendarLayer')"></strong>
                </div>
            </div>
        <!-- </div> -->

        <div class="search-item pax-select" onClick="seatView()">
            <span class="label">Ïù∏Ïõê</span>
            <strong id="seat-box">ÏÑ±Ïù∏ 1</strong>
        </div>
        
        <button class="search-btn cursor" onClick="return interSearch()">üîç Í≤ÄÏÉâ</button>
        <div style="position :relative;">
            <%- include("mem.inc") %>
        </div>
    </div>
     
    <div class="city-layer" id="CityLayer">
        <div class="layer-box city-modal">
            <div class="city-head">
                <strong>ÎèÑÏãú ÏÑ†ÌÉù</strong>
                <button class="close" onClick="$('.city-layer').removeClass('is-open')">√ó</button>        
            </div>
            <div class="city-body city-body-split">
                <ul class="region-list"></ul>

                <div class="city-list-area">
                    <div class="city-list" id="cityData"></div>
                    <div class='city-list' ID="CitySearchBoxData" style="max-height:260px;overflow-y: auto;"></div>
                </div>   
            </div>
        </div>
    </div>
    
    <div class='calendar-layer' ID='CalendarLayer'>
        <div class='layer-box'>
            <div class='layer-head'>
                <strong>ÎÇ†Ïßú ÏÑ†ÌÉù</strong>
                <button class='close' onClick="calClose ('CalendarLayer')">√ó</button>
            </div>
            <div class='calendar-layer-data'  ID='CalendarLayerData'></div>
        </div>
    </div>

    <div class='city_search_box' style="display:none;width: 500px;" ID="CitySearchBox">
        <div class='pop_section'>
            <div class='pa815 title_bold'>ÎèÑÏãúÏ†ïÎ≥¥</div>
            <img class='cal_close_img' src='/images/close_img.png'>
        </div>
        
    </div>
         <!--//Ïó¨ÌñâÏßÄÏó≠ ÏÑ†ÌÉù-->
    <%- include("filter.inc") %>
    <%- include("form.inc") %> 
    </form>
    
    <div  class="result-panel">
         <!--page_item_content-->
         <div  class="page_item_content page_item_content2">	
             <!--list-wrap-->
             <div class="banner_btn_wrap none">
                 <div class="swiper-button-prev bbw bb_prev" onClick="event.cancelBubble=true;"></div>
                 <div class="swiper-button-next bbw bb_next" style="right:0px !important;"></div>
             </div>
             <div class="list-wrap air_container" id="SearchSub" style="display:none;">
                 <div class="swiper-wrapper">
                    <% for (let ix = 1; ix < 7; ix++) { 
                        const non = ix > 2 ? "none" : "";
                    %>
                       <div class='list-wrap-50 swiper-slide <%= non %>' style='padding-right:1%; ' id='itiRoute_<%= ix %>'>
                           <p class='tit' id='RouteImg<%= ix %>'><img src='/images/departure.png' class='icon_img'>Ïó¨Ï†ï <%= ix %></p>
                   
                           <p class='arr_txt'>
                               <span class='preNextButton_<%= ix %> $none' onclick="return prevDaySearch('<%= ix %>')" style='background-color: #3f51b5;padding: 3px 8px; border-radius:4px; margin-right:10px;color:#fff; cursor:pointer;'>Ïù¥Ï†ÑÎÇ†</span>
                               <span id='airCityName<%= ix %>'>Ï∂úÎ∞úÏßÄ -> ÎèÑÏ∞©ÏßÄ</span>
                               <span class='preNextButton_<%= ix %> $none' onclick="return nextDaySearch('<%= ix %>')" style='background-color: #3f51b5;padding: 3px 8px; border-radius:4px; margin-left:10px;color:#fff; cursor:pointer;'>Îã§ÏùåÎÇ†</span>
                           </p>
                   
                           <div class='info_date'>
                               <span class='s1'><span id='airDateName<%= ix %>'></span></span>
                           </div>
                           <div class='bar'></div>
                           <div class='list__ air-list-form2' id='airListForm<%= ix %>'>
                               <div class='list-roll' id='airListArea<%= ix %>'></div>
                           </div>
                       </div>
                    <% } %>
            </div>
                 
             </div>
            
             <div id="MonthData" class="monthArea mat10" style="display:none">
 
             </div>
             <div id="SearchNotice">
                <form name='frmSearch' id="frmSearch" onsubmit="return formSearch(event)">
                <input type="hidden" name="mode" value="NEWSLIST">
                <input type="hidden" name="page" value="1">
                    <div id="searchFrame">
                        <div class="search_action_bar">
                            <div class="search_action_left">
                                <span class="section-title">Ìï≠Í≥µÏÇ¨ Îâ¥Ïä§</span>
                            </div>
                            
                            <div class="search_action_right">
                                
                                <span class="unit">Ìï≠Í≥µÏÇ¨</span>                                
                                <input type='text' name='sAir' class='wh100'>
                                <span class="unit">Ï†úÎ™©</span>    
                                <input type='text' name='sWord' class='wh100'>
                                <button type="submit" class="search_action_icon_btn" aria-label="Í≤ÄÏÉâ">üîç</button>
                            </div>
                        </div>
                            
                        
        
                        <div id="listFrameSub" class="search-panel">
                            
                        </div>
                        <div class="action_bar_split">
                            <div class="action_area_left">
                                &nbsp;
                                
                            </div>
                            <div id="pageHTML" class="action_area_center">
                            
                            </div>
                            <div class="action_area_right">
                                &nbsp;
                                
                            </div>
                        </div>
                    </div>
                </form>
            </div>
         </div>
         <!--//page_item_content-->
         
    </div>
    
     
     <!--//air-page-quickbar-->
 
<!--ÏòàÏïΩÏÉÅÏÑ∏ÌåùÏóÖ-->
<!-- <div id="detail-popup" style="display:none"></div> -->
 <!--ÏòàÏïΩÏÉÅÏÑ∏ÌåùÏóÖ-->
 
 <div class="popup-layer" id="info_popup">
     <div class="content">
         <div class="layer-inner2">
             <img src="../images/close_img.png" class="close_img" alt="ÌåùÏóÖÎã´Í∏∞" onClick="$('#info_popup').hide();">
             <div id="info_data" class="info_data" >
 
             </div>
         </div>
     </div>
 </div>
 <div id="basePopUp" style="display:none"></div>
 
         <div id="basePopUp2" style="display:none"></div>
    
 </div>
 <form name="frmModify" id="frmModify" method="post" >
	<input type="hidden" name="mode"		value="">
	<input type="hidden" name="uid">

</form>
<div id="basePopUp" style="display:none"></div>
<script type="text/javascript">
<!--

    gData = {};
	searchCnt   = 1;
	totalCnt    = 1;
	docHeight   = 0;
    monthActive = "";
	airActive   = "";
	
	function modalTabClear (name) {
		if (document.getElementById("cabinCheck1").checked == true && name != "cabinCheck1") document.getElementById("cabinCheck1").checked = false ;
		if (document.getElementById("cabinCheck2").checked == true && name != "cabinCheck2") document.getElementById("cabinCheck2").checked = false;
		for (ix = 1 ; ix < 7 ; ix ++) {
			if (document.getElementById("cabinCheck"+ix+"_")) {
                 if (document.getElementById("cabinCheck"+ix+"_").checked == true && name != "cabinCheck"+ix+"_") document.getElementById("cabinCheck"+ix+"_").checked = false;
            }
		}
	}
	

    function resizeFrame() {
        const $mainFrame = parent.$(".mainFrame_on");
        if ($mainFrame.length > 0) {
            const docHeight = $mainFrame.height() - 85;
            $(".main_frame, .search_frame").css("height", docHeight);
        }
    }


	async function newsDetail (uid) {
		//$("#info_popup").toggle();
        //searchDatas ('NEWS',uid);
        frmModify.uid.value      = uid;
        frmModify.mode.value     = 'NEWS';
        LoadingStart ();
        json = await dataSaveSend ('frmModify','/SearchGet');
		const title   = json.title;
		const html    = json.html;
		drawer.open(1000, { title, html  });
        LoadingStop();
        
	
	}

    function airLikeCheck (code) {
        searchDatas ('airCheck',code);
	}

	function ageCheck () {
        interSearchClose();
        searchDatas ('ageCheck');
	}
    function recentSearch(){
        interSearchClose();
		searchDatas ('recentCheck');
	}
	function calculateAge () {
		const startDate  = $("#startDate").val();
		const birthDay    = $("#birthDay").val();
		
		const aStart      = startDate.split("-");
		const aBirth      = birthDay.split("-");

		let age = aStart[0] - aBirth[0];
		// ÌòÑÏû¨ ÏõîÍ≥º ÏÉùÏùºÏùò ÏõîÏùÑ ÎπÑÍµêÌï©ÎãàÎã§.
		if (aStart[1] < aBirth[1]) {
			age--;
		}
		// ÌòÑÏû¨ ÏõîÍ≥º ÏÉùÏùºÏùò ÏõîÏù¥ Í∞ôÏùÄ Í≤ΩÏö∞, ÌòÑÏû¨ ÏùºÍ≥º ÏÉùÏùºÏùò ÏùºÏùÑ ÎπÑÍµêÌï©ÎãàÎã§.
		else if (aStart[1] === aBirth[1] && aStart[2] < aBirth[2]) {
			age--;
		}
		$("#ageValue").html(age);
	}

    function firstSet () {
        let date1 = getCookie("AviaSearchDate1");
        let date2 = getCookie("AviaSearchDate2");

        date1 = date1 || getFutureDate(2); // Í∏∞Î≥∏ 2Ïùº Îí§
        const week1 = getWeekFromDateStr(date1);
        
        // formÏù¥ ÏûàÏúºÎ©¥ value ÏÑ§Ï†ï, ÏóÜÏñ¥ÎèÑ ÌÖçÏä§Ìä∏Îäî ÌëúÏãú
        if (document.frmForm && document.frmForm.departure_date) {
            document.frmForm.departure_date.value = date1;
        }
        $("#departure_date_name").html(CutDate(date1) + " (" + getWeek(week1) + ")");

        date2 = date2 || getFutureDateFrom(date1, 2); // date1 Í∏∞Ï§Ä 2Ïùº Îí§
        const week2 = getWeekFromDateStr(date2);
        
        // formÏù¥ ÏûàÏúºÎ©¥ value ÏÑ§Ï†ï, ÏóÜÏñ¥ÎèÑ ÌÖçÏä§Ìä∏Îäî ÌëúÏãú
        if (document.frmForm && document.frmForm.arrive_date) {
            document.frmForm.arrive_date.value = date2;
        }
        $("#arrive_date_name").html(CutDate(date2) + " (" + getWeek(week2) + ")");
    }

	$(document).ready(function(){
        resizeFrame();
        searchDatas ("CITY");    
        // ÎÇ†Ïßú ÌÖçÏä§Ìä∏Îäî Ï¶âÏãú ÌëúÏãú, formÏùÄ ÎÇòÏ§ëÏóê ÏÑ§Ï†ï
        firstSet();
        // formÏù¥ ÏôÑÏ†ÑÌûà Î°úÎìúÎêú ÌõÑ value Ïû¨ÏÑ§Ï†ï
        setTimeout(function() {
            if (document.frmForm && document.frmForm.departure_date) {
                const date1 = document.frmForm.departure_date.value || getCookie("AviaSearchDate1") || getFutureDate(2);
                const date2 = document.frmForm.arrive_date.value || getCookie("AviaSearchDate2") || getFutureDateFrom(date1, 2);
                document.frmForm.departure_date.value = date1;
                document.frmForm.arrive_date.value = date2;
            }
        }, 200);
	});

    async function formSearch (e,page=1) {
        if (e) e.preventDefault();
        frmSearch.page.value = page;
		LoadingStart ();
        json = await dataSaveSend ('frmSearch','/SearchGet');
		success = json.success;
		if (success === "ok") {
            const datas  = json.news;
            const paging = json.pageHTML;
            $("#listFrameSub").html(datas);
            $("#pageHTML").html(paging);
		} else {
            newAlert('Î™©Î°ùÌò∏Ï∂úÏ§ë Ïò§Î•ò Î∞úÏÉù');
		}
		LoadingStop();
        return false;
	};

    async function searchDatas (mode,uid='') {
        //if (mode == "CITY") {
            const data = 'mode='+mode+'&uid='+uid;
            const res  = await fetch('/searchGet', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: data
            });
        //}

        const json  = await res.json();
        if (mode == "CITY") {
            // ÎèÑÏãú Îç∞Ïù¥ÌÑ∞Î•º ÌååÏã±Ìï¥ÏÑú region-listÏôÄ city-listÎ°ú Î≥ÄÌôò
            // ÏûÑÏãú Ïª®ÌÖåÏù¥ÎÑàÏóê HTMLÏùÑ ÎÑ£Ïñ¥ÏÑú ÌååÏã±
            const $temp = $('<div>').html(json.city);
            const regionList = [];
            const cityDataByRegion = {};
            
            // Í∞Å ÏßÄÏó≠Î≥ÑÎ°ú Îç∞Ïù¥ÌÑ∞ ÏàòÏßë
            $temp.find('.list-0').each(function() {
                const $item = $(this);
                const region = $item.find('.city-tit').text().trim();
                if (!region) return;
                
                regionList.push(region);
                const cities = [];
                
                $item.find('ul li a').each(function() {
                    const $link = $(this);
                    const onClick = $link.attr('onClick') || $link.attr('onclick');
                    if (onClick) {
                        const match = onClick.match(/cityChoice\('([^']+)','([^']+)','([^']+)'\)/);
                        if (match) {
                            cities.push({
                                code: match[1],
                                name: match[2],
                                name_en: match[3]
                            });
                        }
                    }
                });
                
                cityDataByRegion[region] = cities;
            });
            
            // ÏôºÏ™Ω region-list ÏÉùÏÑ±
            let regionHtml = '';
            regionList.forEach((region, index) => {
                const activeClass = index === 0 ? 'active' : '';
                regionHtml += `<li class="${activeClass}" data-region="${region}">${region}</li>`;
            });
            $('.region-list').html(regionHtml);
            
            // Ïò§Î•∏Ï™Ω city-list ÏÉùÏÑ± (Ï≤´ Î≤àÏß∏ ÏßÄÏó≠Ïùò ÎèÑÏãúÎì§)
            const firstRegion = regionList[0];
            if (firstRegion && cityDataByRegion[firstRegion]) {
                let cityHtml = '';
                cityDataByRegion[firstRegion].forEach(city => {
                    cityHtml += `<button type="button" onClick="cityChoice('${city.code}','${city.name}','${city.name_en}')">${city.name}</button>`;
                });
                $('#cityData').html(cityHtml);
            }
            
            // ÏßÄÏó≠ ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            $(document).off('click', '.region-list li').on('click', '.region-list li', function() {
                $('.region-list li').removeClass('active');
                $(this).addClass('active');
                $("#CitySearchBoxData").hide();
			    $("#cityData").show();
                const region = $(this).data('region');
                if (cityDataByRegion[region]) {
                    let cityHtml = '';
                    cityDataByRegion[region].forEach(city => {
                        cityHtml += `<button type="button" onClick="cityChoice('${city.code}','${city.name}','${city.name_en}')">${city.name}</button>`;
                    });
                    $('#cityData').html(cityHtml);
                }
            });
            
            $("#listFrameSub").html(json.news);
            $("#pageHTML").html(json.pageHTML);
            gData = json.cityData;
            
            // ÎîîÎ≤ÑÍπÖÏö© ÏΩòÏÜî Î°úÍ∑∏
            //console.log('Region List:', regionList);
            //console.log('City Data By Region:', cityDataByRegion);
            //console.log('First Region Cities:', cityDataByRegion[firstRegion]);
        } else if (mode == "NEWS") {
            $("#info_data").html(json.detail);
        } else if (mode == "airCheck") {
            $("#SearchAirLike").html(json.airData);
            $("#SearchCityLike").html(json.cityData);
        } else if (mode == "ageCheck") {
            smallPopHide ();
            $("#revPopup").show();
            $("#revPopup").html(json.ageData);
            // iframe Ïä§ÌÅ¨Î°§Î∞î Ï†úÍ±∞
            document.body.style.overflow = "hidden";
            document.documentElement.style.overflow = "hidden";
        } else if (mode == "recentCheck") {
            smallPopHide ();
            $('#SearchHistory').show();
            $("#SearchHistoryArea").html(json.recentData);
            // iframe Ïä§ÌÅ¨Î°§Î∞î Ï†úÍ±∞
            document.body.style.overflow = "hidden";
            document.documentElement.style.overflow = "hidden";
        }
	};


    const searchFrameNumber = "<%= searchFrameNumber %>";
    function searchHistory (ticket_type,dep_date,arr_date,src,src_name,dest,dest_name,adt_mem,chd_mem,inf_mem,week1,week2,stopover,addCode,addDate,addWeek,grade) {
		typeChange (ticket_type);
		if (ticket_type == "3") {
			aDate = addDate.split(",");
			aCode = addCode.split(",");
			aWeek = addWeek.split(",");
			currentCity = 1 ;
			currentSub  = 1 ;
			cityChoice(src,src_name);
			currentCity = 2 ;
			currentSub  = 1 ;
			cityChoice(dest,dest_name);
			cabinChangeSingle(1,grade.substring(0,1));

			// ÎëêÎ≤àÏß∏
			currentCity = 1 ;
			currentSub  = 2 ;
			cityChoice(aCode[0],aCode[1]);

			currentCity = 2 ;
			currentSub  = 2 ;
			cityChoice(aCode[2],aCode[3]);
			cabinChangeSingle(2,grade.substring(1,2));

			if (aCode[4] != "") {
				if (!$("#Route_3").length) addRouting ("+");
				// ÏÑ∏Î≤àÏß∏
				currentCity = 1 ;
				currentSub  = 3 ;
				cityChoice(aCode[4],aCode[5]);

				currentCity = 2 ;
				currentSub  = 3 ;
				cityChoice(aCode[6],aCode[7]);
				//clog('a');
				cabinChangeSingle(3,grade.substring(2,3));

				//clog('b');
			}

			if (aCode[8] != "") {
				if (!$("#Route_4").length) addRouting ("+");
				// ÎÑ§Î≤àÏß∏
				currentCity = 1 ;
				currentSub  = 4 ;
				cityChoice(aCode[8],aCode[9]);

				currentCity = 2 ;
				currentSub  = 4 ;
				cityChoice(aCode[10],aCode[11]);
				cabinChangeSingle(4,grade.substring(3,4));
			}

			yy = dep_date.substring(0,4);
			mm = dep_date.substring(4,6);
			dd = dep_date.substring(6,8);
			//setInterCal(yy,mm,dd,'dep_date1','frmForm','CalendarLayer','',week1,'','');
            frmForm.dep_date1.value = yy+mm+dd;

			yy = aDate[0].substring(0,4);
			mm = aDate[0].substring(4,6);
			dd = aDate[0].substring(6,8);
			//setInterCal(yy,mm,dd,'dep_date2','frmForm','CalendarLayer','',aWeek[0],'','');
            frmForm.dep_date2.value = yy+mm+dd;

			if (aDate[1] != "") {
				yy = aDate[1].substring(0,4);
				mm = aDate[1].substring(4,6);
				dd = aDate[1].substring(6,8);
				setInterCal(yy,mm,dd,'dep_date3','frmForm','CalendarLayer','',aWeek[1],'','');
                frmForm.dep_date3.value = yy+mm+dd;
			}
			if (aDate[2] != "") {
				yy = aDate[2].substring(0,4);
				mm = aDate[2].substring(4,6);
				dd = aDate[2].substring(6,8);
				setInterCal(yy,mm,dd,'dep_date4','frmForm','CalendarLayer','',aWeek[2],'','');
                frmForm.dep_date4.value = yy+mm+dd;
			}
		} else {
			currentCity = 1 ;
			currentSub  = 0 ;
			cityChoice(src,src_name);
			currentCity = 2 ;
			currentSub  = 0 ;
			cityChoice(dest,dest_name);
			yy = dep_date.substring(0,4);
			mm = dep_date.substring(4,6);
			dd = dep_date.substring(6,8);
			//setInterCal(yy,mm,dd,'departure_date','frmForm','CalendarLayer','',week1,'','');
            frmForm.departure_date.value = yy+mm+dd;
			cabinChangeSingle(1,grade.substring(0,1));

			yy = arr_date.substring(0,4);
			mm = arr_date.substring(4,6);
			dd = arr_date.substring(6,8);
			//setInterCal(yy,mm,dd,'arrive_date','frmForm','CalendarLayer','',week2,'','');
            frmForm.arrive_date.value = yy+mm+dd;
			if (grade.substring(1,2)) cabinChangeSingle(2,grade.substring(1,2));
		}

		if (stopover == "") {
			document.frmForm.stopover.checked = false; 
		} else {
			document.frmForm.stopover.checked = true; 
		}


		document.frmForm.adt.value = adt_mem;
		document.frmForm.chd.value = chd_mem;
		document.frmForm.inf.value = inf_mem;
		memberSet ();
		interSearch ();

		$('#SearchHistory').hide();
		document.body.style.overflow = '';
		document.documentElement.style.overflow = '';
	}
	function motionClick (dep,cnt) {
		$("#OpenView"+dep+"_"+cnt).slideDown("fast");
		$("#OpenView"+dep+"2_"+cnt).slideDown("fast");
		$("DepartureBox"+dep+"_"+cnt).toggleClass("fast");
		$('.item-in.item-innn').each(function(index) {
			// Calculating height as (index + 1) * 100%
			var heightValue = (index + 1) * 115 + '%';

			// Generating dynamic CSS to apply
			var dynamicCss = '<style>.item-in.item-innn:nth-of-type(' + (index + 1) + ')::before {height: ' + heightValue + ';}</style>';

			// Appending the dynamic CSS to the head of the document
			$('head').append(dynamicCss);
		});
	}

    function goDetail(day,week){
		
		yy = day.substr(0,4);
		mm = day.substr(4,2);
		dd = day.substr(6);
		tmp = yy+"-"+mm+"-"+dd;

		$("#tmpData").val(tmp);
		$("#tmpData2").val(week);

		let week2 = ['2','3','4','5','6','0','1'];
		set_inter_basic(yy,mm,dd,'departure_date','frmForm','CalendarLayer','',week,tmp,week2[week]);

		interSearch();
	}

//-->
</script>

<div id="smallPopup"  style="display: none;">		
    <div id="smallPopup_arti" >
        <img src="/img/detail_img_closed_gray.png" id="closeBtn" class="wh20 hh20" onClick="smallPopHide ()">
        <div ID="smallPopupData"></div>
    </div>
</div>
<%- include('../footer_log') %>