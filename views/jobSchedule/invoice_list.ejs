<%- include('../header') %>

<main class="content">


	<form name="frmSearch" id="frmSearch" method="post" onsubmit="return formSearch(event);">
	<input type="hidden" name="menuCol"   value="">
    <input type="hidden" name="mode"      value="interSearch">
	<input type="hidden" name="page"      value="1">
	<input type="hidden" name="titleData" value="인보이스 관리">
		<div id="searchFrame">
			<div class="search_action_bar">
				<div class="search_action_left">
					<span onClick="newReg('','input')"  class="search_action_btn_primary">+ 신규등록</span>
				</div>
				<div class="search_action_right">
					<input name="listCount" type="text" value="15" class="search_action_search_input wh40" placeholder="줄수" />
					<span class="unit">줄수</span>
					<input name="start_date" type="text" value="" class="search_action_search_input wh100" placeholder="시작일" />
					<span class="unit">시작일</span>
					<input name="end_date" type="text" value="" class="search_action_search_input wh100" placeholder="종료일" />
					<span class="unit">종료일</span>
					<select name="GU1" class="search_action_select"  >
						<option value=""  >전체
						<option value="0" >진행
						<option value="1" >완료
					</select>
					<div  id="memDatas">
                            
					</div>
					<select name="sFrom" class="search_action_select">
						<option value="subject"	>제목</option>
					</select>
					<input name="sWord" type="text" value="" class="search_action_search_input" placeholder="검색어를 입력하세요" />
					<button type="submit" class="search_action_icon_btn" aria-label="검색">🔍</button>
				</div>
			</div>
		</div>
	</form>

	<form name="frmForm" method="post" id="frmForm">
	<input type="hidden" name="uid"  value="">
	<input type="hidden" name="mode" value="">
	<div ID="listFrame" >
		<div ID="listFrameSub" class="search-panel">
			<table class='search-table' id='dtBasic'>
				<tr>
                    <th>No</th>
					<th>제목</th>
					<th>작성자</th>
					<th>등록일</th>
					<th>미리보기</th>
					<th>수정</th>
					<th>삭제</th>
				</tr>
				
			</table>
		</div>
	</div>
	</form>
	<div class="action_bar_split">
		<div class="action_area_left">
			&nbsp;
		</div>
		<div class="action_area_center" id="pagingHTML">
		</div>
		<div class="action_area_right">			
			<button class="action_btn_download excel" onClick="return excelDown()" >
				<span class="icon">📊</span>

				엑셀 다운로드
			</button>
		</div>
	</div>

</main>
<form name="frmModify" id="frmModify" method="post" >
	<input type="hidden" name="mode"		value="">
	<input type="hidden" name="num">
</form>
<div id="basePopUp" style="display:none"></div>
<script type="text/javascript">
<!--
	async function newReg (num,uid='') {
		json = await dataGetSend('Invoice',num, 'jobSchedule/invoiceSave');
		frmModify.num.value = num;
		title = json.title;
		html  = json.html;
		drawer.open(900, { title, html  });
	}

	$(document).ready(function() {
		//frmSearch.submit ();
		formSearch (event);
	});

    async function formSearch (e) {
        if (e) e.preventDefault();
		LoadingStart ();
        json = await dataSaveSend ('frmSearch','/jobSchedule/invoice_list');
		success = json.success;
		if (success === "ok") {
			const datas  = json.listData;
            const paging = json.pageData;
            $("#listFrameSub").html(datas);
            $("#pagingHTML").html(paging);
            $("#totCount").html(`(${json.totCount})`);
            $("#memDatas").html(json.mems);
		} else {
			newAlert('목록 호출중 오류 발생');
		}
		LoadingStop();
        return false;
	};


    async function filePrint() {
		const savePos = $("#savePos").val();
		if (savePos == "print") {
			const InvoiceData = $("#InvoiceData").html();
            hidePrintAction(InvoiceData);
		} else if (savePos == "email") {
			const emailData = $("#emailData").html();
			emailSend(emailData);
		} else if (savePos == "image") {
			// html2canvas로 이미지 생성 후 서버에 저장
			LoadingStart();
			let docNumber = frmModify.num.value;
			pngSave('InvoiceData', docNumber);
			LoadingStop();
		}
		return false;
	}
//-->
</script>

<%- include('../footer_log') %>